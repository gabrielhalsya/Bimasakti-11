@page "/GLM00200"
@using GLM00200Common;
@using GLM00200Common.DTO_s;
@attribute [R_Page(Title = "RecurringList")]
@inherits R_Page

<R_PredefinedDock R_InstantiateDock="@Predef_RecurringEntry" R_AfterOpenPredefinedDock="@AfterPredef_RecurringEntry" Title="Recurring Entry"></R_PredefinedDock>
<R_PredefinedDock R_InstantiateDock="@Predef_ActualJournalList" R_AfterOpenPredefinedDock="@AfterPredef_ActualJournalList" Title="Actual Journal List"></R_PredefinedDock>

<R_StackLayout Row="true">
    <R_ItemLayout xs="1">
        <R_Label>Department</R_Label>
    </R_ItemLayout>
    <R_ItemLayout xs="1">
        <R_TextBox @bind-value="_journalVM._SearchParam.CDEPT_CODE"
                   CharacterCasing="R_eCharacterCasing.Upper"></R_TextBox>
    </R_ItemLayout>
    <R_ItemLayout>
        <R_Lookup R_Before_Open_Lookup="Dept_Before_Open_Lookup"
                  R_After_Open_Lookup="Dept_After_Open_Lookup">
            ...
        </R_Lookup>
    </R_ItemLayout>
    <R_ItemLayout>
        <R_TextBox @bind-value="_journalVM._SearchParam.CDEPT_NAME "></R_TextBox>
    </R_ItemLayout>
    <R_ItemLayout>
        <R_Label>Next Journal Period</R_Label>
    </R_ItemLayout>
    <R_ItemLayout xs="1">
        <R_ComboBox @bind-Value="@_journalVM._SearchParam.CPERIOD_MM" Data="_journalVM.Periods" ValueField="@nameof(PeriodDTO.CPERIOD_MM_CODE)" TextField="@nameof(PeriodDTO.CPERIOD_MM_TEXT)"></R_ComboBox>
    </R_ItemLayout>
    <R_ItemLayout xs="1">
        <R_NumericTextBox @bind-Value="@_journalVM._SearchParam.CPERIOD_YYYY" Min="_journalVM._GSM_PERIOD.IMIN_YEAR" Max="_journalVM._GSM_PERIOD.IMAX_YEAR"></R_NumericTextBox>
    </R_ItemLayout>
    <R_ItemLayout>
        <R_Label>Status</R_Label>
    </R_ItemLayout>
    <R_ItemLayout>
        <R_ComboBox @bind-Value="@_journalVM._SearchParam.CSTATUS"
                    Data="_journalVM._STATUS_LIST"
                    ValueField="@nameof(VAR_STATUS_DTO.CCODE)"
                    TextField="@nameof(VAR_STATUS_DTO.CNAME)"></R_ComboBox>
    </R_ItemLayout>
    <R_ItemLayout>
        <R_TextBox @bind-Value="_journalVM._SearchParam.CSEARCH_TEXT" MaxLength="200"></R_TextBox>
    </R_ItemLayout>
    <R_ItemLayout>
        <R_Button OnClick="SearchWithFilterAsync">Search</R_Button>
    </R_ItemLayout>
    <R_ItemLayout>
        <R_Button OnClick="SearchAllAsync">Show All</R_Button>
    </R_ItemLayout>
</R_StackLayout>

<R_Grid @ref="@_gridJournal"
        DataSource="@_journalVM.JournalList"
        Pageable
        R_ConductorGridSource="_conJournal"
        R_GridType="R_eGridType.Original" R_ServiceGetListRecord="JournalGrid_ServiceGetListRecord"
        AllowAddNewRow="false"
        AllowDeleteRow="false"
        AllowEditRow="false">
    <R_GridColumns>
        <R_GridTextColumn FieldName="@nameof(JournalGridDTO.CREF_NO)" HeaderText="Reference No." Width="150px"></R_GridTextColumn>
        <R_GridNumericColumn FieldName="@nameof(JournalGridDTO.IFREQUENCY)" HeaderText="Freq." Width="100px"></R_GridNumericColumn>
        <R_GridNumericColumn FieldName="@nameof(JournalGridDTO.IPERIOD)" HeaderText="Interval(Month)" Width="100px"></R_GridNumericColumn>
        <R_GridDatePickerColumn FieldName="@nameof(JournalGridDTO.DSTART_DATE)" HeaderText="Start Date" Width="100px"></R_GridDatePickerColumn>
        <R_GridDatePickerColumn FieldName="@nameof(JournalGridDTO.DNEXT_DATE)" HeaderText="Next Date" Width="100px"></R_GridDatePickerColumn>
        <R_GridTextColumn FieldName="@nameof(JournalGridDTO.CTRANS_DESC)" HeaderText="Description" Width="150px"></R_GridTextColumn>
        <R_GridTextColumn FieldName="@nameof(JournalGridDTO.CCURRENCY_CODE)" HeaderText="Currency" Width="100px"></R_GridTextColumn>
        <R_GridNumericColumn FieldName="@nameof(JournalGridDTO.NTRANS_AMOUNT)" HeaderText="Amount" Width="100px"></R_GridNumericColumn>
        <R_GridTextColumn FieldName="@nameof(JournalGridDTO.CSTATUS_NAME)" HeaderText="Status" Width="100px"></R_GridTextColumn>
        <R_GridTextColumn FieldName="@nameof(JournalGridDTO.CDOC_NO)" HeaderText="Document No." Width="100px"></R_GridTextColumn>
        <R_GridTextColumn FieldName="@nameof(JournalGridDTO.CDOC_DATE)" HeaderText="Document Date" Width="100px"></R_GridTextColumn>
        <R_GridTextColumn FieldName="@nameof(JournalGridDTO.CUPDATE_BY)" HeaderText="Updated By" Width="100px"></R_GridTextColumn>
        <R_GridDatePickerColumn FieldName="@nameof(JournalGridDTO.DUPDATE_DATE)" HeaderText="Updated Date" Width="100px"></R_GridDatePickerColumn>
        <R_GridTextColumn FieldName="@nameof(JournalGridDTO.CCREATE_BY)" HeaderText="Updated By" Width="100px"></R_GridTextColumn>
        <R_GridDatePickerColumn FieldName="@nameof(JournalGridDTO.DCREATE_DATE)" HeaderText="Updated Date" Width="100px"></R_GridDatePickerColumn>
    </R_GridColumns>
</R_Grid>

<R_ConductorGrid @ref="_conJournal"
                 R_ViewModel="_journalVM"
                      R_IsHeader
                 R_ServiceGetRecord="JournalGrid_ServiceGetRecord"
                 R_Display="JournalGrid_Display">
</R_ConductorGrid>

<R_Grid Class="mt-3" @ref="@_gridJournalDet"
        DataSource="@_journalVM.JournaDetailList"
        Pageable
        R_ConductorGridSource="_conJournalDet"
        R_GridType="R_eGridType.Original" 
        R_ServiceGetListRecord="JournalDetGrid_ServiceGetListRecord" 
        AllowAddNewRow="false"
        AllowDeleteRow="false"
        AllowEditRow="false">
    <R_GridColumns>
        <R_GridNumericColumn FieldName="@nameof(JournalDetailGridDTO.INO)" HeaderText="No." Width="100px"></R_GridNumericColumn>
        <R_GridTextColumn FieldName="@nameof(JournalDetailGridDTO.CGLACCOUNT_NO)" HeaderText="Account No." Width="100px"></R_GridTextColumn>
        <R_GridTextColumn FieldName="@nameof(JournalDetailGridDTO.CGLACCOUNT_NAME)" HeaderText="Account Name" Width="250px"></R_GridTextColumn>
        <R_GridTextColumn FieldName="@nameof(JournalDetailGridDTO.CCENTER_NAME)" HeaderText="Center" Width="100px"></R_GridTextColumn>
        <R_GridTextColumn FieldName="@nameof(JournalDetailGridDTO.CDBCR)" HeaderText="D/C" Width="100px"></R_GridTextColumn>
        <R_GridNumericColumn FieldName="@nameof(JournalDetailGridDTO.NDEBIT)" HeaderText="Debit" Width="100px"></R_GridNumericColumn>
        <R_GridNumericColumn FieldName="@nameof(JournalDetailGridDTO.NCREDIT)" HeaderText="Credit" Width="100px"></R_GridNumericColumn>
        <R_GridTextColumn FieldName="@nameof(JournalDetailGridDTO.CDETAIL_DESC)" HeaderText="Description" Width="150px"></R_GridTextColumn>
        <R_GridNumericColumn FieldName="@nameof(JournalDetailGridDTO.NLDEBIT)" HeaderText="DB (Local)" Width="150px"></R_GridNumericColumn>
        <R_GridNumericColumn FieldName="@nameof(JournalDetailGridDTO.NLCREDIT)" HeaderText="CR (Local)" Width="150px"></R_GridNumericColumn>
        <R_GridNumericColumn FieldName="@nameof(JournalDetailGridDTO.NBDEBIT)" HeaderText="DB (Base)" Width="150px"></R_GridNumericColumn>
        <R_GridNumericColumn FieldName="@nameof(JournalDetailGridDTO.NBCREDIT)" HeaderText="CR (Base)" Width="150px"></R_GridNumericColumn>
    </R_GridColumns>
</R_Grid>

<R_ConductorGrid @ref="_conJournalDet"
                 R_ViewModel="_journalVM"
                 R_ConductorParent="_conJournal">
</R_ConductorGrid>

<R_StackLayout Row>
    <R_ItemLayout xs="1">
        <R_Button>Approve</R_Button>
    </R_ItemLayout>
    <R_ItemLayout xs="1">
        <R_Button>Commit</R_Button>
    </R_ItemLayout>
    <R_ItemLayout xs="2">
        <R_Button>Rapid Approval</R_Button>
    </R_ItemLayout>
    <R_ItemLayout xs="2">
        <R_Button>Rapid Commit</R_Button>
    </R_ItemLayout>
    <R_ItemLayout xs="1" Class="ms-2">
        <R_Popup>Upload</R_Popup>
    </R_ItemLayout>
    <R_ItemLayout xs="1">
        <R_Button>Template</R_Button>
    </R_ItemLayout>
</R_StackLayout>


