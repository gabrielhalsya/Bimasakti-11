@inherits R_Page
@attribute [R_Page(Title = "Assign User Department")]

<R_StackLayout Row Style="width:1000px">
     <R_ItemLayout col="12">
         <R_InputFile OnChange="@UploadExcel" Accepts="@_accepts"></R_InputFile>
         <R_Grid @ref="_gridDeptExcelRef"
                 DataSource="@_deptUploadViewModel.DepartmentExcelValidatedData"
                 R_ConductorGridSource="_conGridDeptExcelRef"
                 Pageable="true"
                 R_GridType="R_eGridType.Batch"
                 R_RowRender="@((R_GridRowRenderEventArgs args) => R_RowRender(args))"
                 R_ServiceGetListRecord="DeptExcelGrid_ServiceGetListRecord"
                 Class="m-1 p-2">
             <R_GridColumns>
                 <R_GridTextColumn FieldName="@nameof(GSM04000ExcelGridDTO.CDEPT_CODE)" HeaderText="Department Code" R_EnableAdd></R_GridTextColumn>
                 <R_GridTextColumn FieldName="@nameof(GSM04000ExcelGridDTO.CDEPT_NAME)" HeaderText="Department Name" R_EnableAdd R_EnableEdit></R_GridTextColumn>
                 <R_GridTextColumn FieldName="@nameof(GSM04000ExcelGridDTO.CCENTER_CODE)" HeaderText="Center Code" R_EnableAdd R_EnableEdit></R_GridTextColumn>
                 <R_GridTextColumn FieldName="@nameof(GSM04000ExcelGridDTO.CCENTER_NAME)" HeaderText="Center Name"></R_GridTextColumn>
                 <R_GridTextColumn FieldName="@nameof(GSM04000ExcelGridDTO.CMANAGER_NAME)" HeaderText="Manager" R_EnableAdd R_EnableEdit></R_GridTextColumn>
                 <R_GridCheckBoxColumn FieldName="@nameof(GSM04000ExcelGridDTO.LEVERYONE)" HeaderText="Everyone" R_EnableAdd R_EnableEdit></R_GridCheckBoxColumn>
                 <R_GridCheckBoxColumn FieldName="@nameof(GSM04000ExcelGridDTO.LACTIVE)" HeaderText="Active" R_EnableAdd R_EnableEdit></R_GridCheckBoxColumn>
                 <R_GridTextColumn FieldName="@nameof(GSM04000ExcelGridDTO.CUPDATE_BY)" HeaderText="Updated By"></R_GridTextColumn>
                 <R_GridTextColumn FieldName="@nameof(GSM04000ExcelGridDTO.DUPDATE_DATE)" HeaderText="Updated  Date"></R_GridTextColumn>
             </R_GridColumns>
         </R_Grid>
         <R_StackLayout Row>
            <R_ItemLayout col="12">
                <R_ProgressBar Label="@_deptUploadViewModel._progressBarMessage" MaxValue="100" Value="@_deptUploadViewModel._progressBarPercentage"></R_ProgressBar>
            </R_ItemLayout>
        </R_StackLayout>

        <R_StackLayout Row>
            <R_ItemLayout col="11">
                <R_Label>Note : Red color indicate the record already exist in master Journal Group</R_Label>
            </R_ItemLayout>
        </R_StackLayout>

        <R_StackLayout Row>
            <R_ItemLayout col="5" Class="d-inline">
                <R_CheckBox @bind-Value="@_deptUploadViewModel._isOverwrite"
                            Enabled="true">
                </R_CheckBox>
                <R_Label>Overwrite existing record</R_Label>
            </R_ItemLayout>
        </R_StackLayout>


        <R_StackLayout Row Class="justify-content-end mt-2">
             <R_ItemLayout col="2">
                 <R_Button OnClick="OnClick_ButtonClose">
                     Cancel
                 </R_Button>
             </R_ItemLayout>
             <R_ItemLayout col="2">
                 <R_Button Enabled="@(_deptUploadViewModel._enableSaveButton||_deptUploadViewModel._isOverwrite)" OnClick="OnClick_ButtonOK">
                     Save
                 </R_Button>
             </R_ItemLayout>
         </R_StackLayout>
     </R_ItemLayout>
 </R_StackLayout>