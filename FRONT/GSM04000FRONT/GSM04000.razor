@page "/GSM04000"
@using GSM04000Common;
@using Microsoft.JSInterop;
@inherits R_Page
@inject IJSRuntime JS

<R_StackLayout>
    <R_ItemLayout>
        <R_Grid @ref="_gridDeptRef"
                DataSource="@_deptViewModel.DepartmentList"
                Pageable="true"
                R_ConductorGridSource="_conGridDeptRef"
                R_GridType="R_eGridType.Original"
                R_ServiceGetListRecord="DeptGrid_ServiceGetListRecord"
                AllowAddNewRow="true"
                AllowDeleteRow="true"
                AllowEditRow="true"
                R_Before_Open_Grid_Lookup="Dept_Before_Open_Lookup"
                R_After_Open_Grid_Lookup="Dept_After_Open_Lookup"
                Width="900px">
            <R_GridColumns>
                <R_GridTextColumn FieldName="@nameof(GSM04000DTO.CDEPT_CODE)" HeaderText="Department Code" R_EnableAdd></R_GridTextColumn>
                <R_GridTextColumn FieldName="@nameof(GSM04000DTO.CDEPT_NAME)" HeaderText="Department Name" R_EnableAdd R_EnableEdit></R_GridTextColumn>
                <R_GridLookupColumn FieldName="@nameof(GSM04000DTO.CCENTER_CODE)" Name="CCENTER" HeaderText="Center Code" R_EnableAdd="true" R_EnableEdit="true"></R_GridLookupColumn>
                <R_GridTextColumn FieldName="@nameof(GSM04000DTO.CCENTER_NAME)" HeaderText="Center Name" R_EnableAdd=false R_EnableEdit=false></R_GridTextColumn>
                <R_GridLookupColumn FieldName="@nameof(GSM04000DTO.CMANAGER_NAME)" Name="CMANAGER_NAME" HeaderText="Manager" R_EnableAdd R_EnableEdit></R_GridLookupColumn>
                <R_GridCheckBoxColumn FieldName="@nameof(GSM04000DTO.LEVERYONE)" HeaderText="Everyone" R_EnableAdd R_EnableEdit></R_GridCheckBoxColumn>
                <R_GridCheckBoxColumn FieldName="@nameof(GSM04000DTO.LACTIVE)" HeaderText="Active" R_EnableAdd R_EnableEdit></R_GridCheckBoxColumn>
                <R_GridTextColumn FieldName="@nameof(GSM04000DTO.CUPDATE_BY)" HeaderText="Last Update By"></R_GridTextColumn>
                <R_GridTextColumn FieldName="@nameof(GSM04000DTO.DUPDATE_DATE)" HeaderText="Last Update Date"></R_GridTextColumn>
            </R_GridColumns>
        </R_Grid>
    </R_ItemLayout>
    <R_StackLayout xs="4" Row="true" Class="m-1">
        <R_ItemLayout xs="1">
            <R_Button OnClick="@DownloadTemplateAsync" R_ConductorGridSource="_conGridDeptRef" R_EnableOther>
                <R_Label>Template</R_Label>
            </R_Button>
        </R_ItemLayout>
        <R_ItemLayout xs="1" Class="ms-1">
            <R_Popup R_Before_Open_Popup="R_Before_Open_PopupUpload" R_ConductorGridSource="_conGridDeptRef"  Enabled="false"><R_Label>Upload</R_Label></R_Popup>
        </R_ItemLayout>
        <R_ItemLayout xs="1" Class="ms-1">
            <R_Popup @ref="R_PopupAssignUser" R_Before_Open_Popup="@R_Before_Open_PopupAssignUser" R_After_Open_Popup="@R_After_Open_PopupAssignUser" R_ConductorGridSource="_conGridDeptRef" R_EnableOther>
                <R_Label>Assign User</R_Label>
            </R_Popup>
        </R_ItemLayout>
        <R_ItemLayout xs="1" Class="ms-1">
            <R_Popup @ref="R_PopupActiveInactive" R_ConductorGridSource="@_conGridDeptRef"
                     R_Before_Open_Popup="R_Before_Open_Popup_ActivateInactive"
                     R_After_Open_Popup="R_After_Open_Popup_ActivateInactive"
                     R_EnableOther>
                <R_Label>@loLabelActiveInactive</R_Label>
            </R_Popup>
        </R_ItemLayout>
    </R_StackLayout>

    <R_StackLayout Row Class="mt-5">
        <R_Label FontStyle="R_eFontStyle.Bold">ASSIGNED USERS</R_Label>
    </R_StackLayout>
    <R_StackLayout Row>
        <R_ItemLayout xs="1">
            <R_Label>Department</R_Label>
        </R_ItemLayout>
        <R_ItemLayout xs="2">
            <R_TextBox @bind-Value="@_deptUserViewModel.Data.CDEPT_CODE"
                       R_ConductorGridSource="@_conGridDeptUserRef" Enabled=false></R_TextBox>
        </R_ItemLayout>
        <R_ItemLayout xs="3">
            <R_TextBox @bind-Value="@_deptUserViewModel.Data.CDEPT_NAME"
                       R_ConductorGridSource="@_conGridDeptUserRef" Enabled=false></R_TextBox>
        </R_ItemLayout>
    </R_StackLayout>

    <R_StackLayout Row>
        <R_ItemLayout xs="9">
            <R_Grid @ref="_gridDeptUserRef"
                    DataSource="@_deptUserViewModel.DepartmentUserList"
                    R_ConductorGridSource="_conGridDeptUserRef"
                    Pageable="true"
                    R_GridType="R_eGridType.Original"
                    AllowAddNewRow="false"
                    AllowDeleteRow="true"
                    AllowEditRow="false"
                    R_ServiceGetListRecord="@DeptUserGrid_ServiceGetListRecord">
                <R_GridColumns>
                    <R_GridTextColumn FieldName="CUSER_ID" HeaderText="User ID"></R_GridTextColumn>
                    <R_GridTextColumn FieldName="CUSER_NAME" HeaderText="User Name"></R_GridTextColumn>
                    <R_GridTextColumn FieldName="CUPDATE_BY" HeaderText="Last Update By"></R_GridTextColumn>
                    <R_GridTextColumn FieldName="DUPDATE_DATE" HeaderText="Last Update Date"></R_GridTextColumn>
                </R_GridColumns>
            </R_Grid>
        </R_ItemLayout>
        <R_ItemLayout xs="6">

        </R_ItemLayout>
    </R_StackLayout>
</R_StackLayout>

<R_ConductorGrid @ref="@_conGridDeptRef"
                 R_ViewModel="@_deptViewModel"
                      R_IsHeader
                 R_Display="@DeptGrid_Display"
                 R_ServiceGetRecord="@DeptGrid_ServiceGetRecord"
                 R_ServiceDelete="@DeptGrid_ServiceDelete"
                 R_ServiceSave="@DeptGrid_ServiceSave"
                 R_DisableDeleteConfirmation=false
                 R_Validation="@DeptGrid_Validation">
</R_ConductorGrid>

<R_ConductorGrid @ref="@_conGridDeptUserRef"
                 R_ViewModel="@_deptUserViewModel"
                 R_ConductorParent="@_conGridDeptRef"
                 R_ServiceGetRecord="@DeptUserGrid_ServiceGetRecord"
                 R_ServiceDelete="@DeptUserGrid_ServiceDelete"></R_ConductorGrid>



